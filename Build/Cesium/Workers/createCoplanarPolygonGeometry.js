define(["./arrayRemoveDuplicates-74caa2f4","./BoundingRectangle-1d700ce8","./buildModuleUrl-d920237a","./Cartesian2-2b41fabe","./Cartographic-1d953166","./Check-2514d21d","./ComponentDatatype-07894a2b","./CoplanarPolygonGeometryLibrary-bd08ceeb","./when-d186add7","./Rectangle-f841217d","./GeometryAttribute-95780fd1","./GeometryAttributes-9c67dd14","./GeometryInstance-2076821b","./GeometryPipeline-6f0b08bc","./IndexDatatype-61ffec74","./Math-7f5f2992","./FeatureDetection-4281d393","./PolygonGeometryLibrary-190f4e75","./PolygonPipeline-6809c3ce","./VertexFormat-769ac289","./Event-50568704","./RuntimeError-4a74cd1a","./WebGLConstants-8d1e45f7","./OrientedBoundingBox-9c607ea0","./Cartesian4-3408960c","./EllipsoidTangentPlane-e12285fe","./IntersectionTests-300d4352","./Plane-d9914d3c","./Buffer-455831f6","./Color-2b4500b6","./AttributeCompression-16430ee7","./EncodedCartesian3-e527b85b","./ArcType-198c1070","./EllipsoidRhumbLine-394d2834"],(function(e,t,n,o,a,r,i,p,c,s,l,y,d,u,g,m,v,h,f,b,w,A,P,x,D,F,T,_,k,L,E,C,R,I){"use strict";var H=new a.t,G=new t.f,O=new o.o,B=new o.o,z=new a.t,N=new a.t,S=new a.t,j=new a.t,M=new a.t,U=new a.t,V=new l.n,Y=new v.p,q=new v.p,J=new a.t;function Q(e,t,n,r,p,c,s,d){var u=e.positions,h=f.A.triangulate(e.positions2D,e.holes);h.length<3&&(h=[0,1,2]);var b=g.IndexDatatype.createTypedArray(u.length,h.length);b.set(h);var w=Y;if(0!==r){var A=l.n.fromAxisAngle(c,r,V);if(w=v.p.fromQuaternion(A,w),t.tangent||t.bitangent){A=l.n.fromAxisAngle(c,-r,V);var P=v.p.fromQuaternion(A,q);s=a.t.normalize(v.p.multiplyByVector(P,s,s),s),t.bitangent&&(d=a.t.normalize(a.t.cross(c,s,d),d))}}else w=v.p.clone(v.p.IDENTITY,w);var x=B;t.st&&(x.x=n.x,x.y=n.y);for(var D=u.length,F=3*D,T=new Float64Array(F),_=t.normal?new Float32Array(F):void 0,k=t.tangent?new Float32Array(F):void 0,L=t.bitangent?new Float32Array(F):void 0,E=t.st?new Float32Array(2*D):void 0,C=0,R=0,I=0,G=0,z=0,N=0;N<D;N++){var S=u[N];if(T[C++]=S.x,T[C++]=S.y,T[C++]=S.z,t.st){var j=p(v.p.multiplyByVector(w,S,H),O);o.o.subtract(j,x,j);var M=m.e.clamp(j.x/n.width,0,1),U=m.e.clamp(j.y/n.height,0,1);E[z++]=M,E[z++]=U}t.normal&&(_[R++]=c.x,_[R++]=c.y,_[R++]=c.z),t.tangent&&(k[G++]=s.x,k[G++]=s.y,k[G++]=s.z),t.bitangent&&(L[I++]=d.x,L[I++]=d.y,L[I++]=d.z)}var J=new y.a;return t.position&&(J.position=new l.o({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:T})),t.normal&&(J.normal=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:_})),t.tangent&&(J.tangent=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:k})),t.bitangent&&(J.bitangent=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:L})),t.st&&(J.st=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:E})),new l.I({attributes:J,indices:b,primitiveType:v._0x12cc5d.TRIANGLES})}function W(e){var t=(e=c.u(e,c.u.EMPTY_OBJECT)).polygonHierarchy;r.o.defined("options.polygonHierarchy",t);var n=c.u(e.vertexFormat,b.n.DEFAULT);this._vertexFormat=b.n.clone(n),this._polygonHierarchy=t,this._stRotation=c.u(e.stRotation,0),this._ellipsoid=s.t.clone(c.u(e.ellipsoid,s.t.WGS84)),this._workerName="createCoplanarPolygonGeometry",this.packedLength=h.y.computeHierarchyPackedLength(t)+b.n.packedLength+s.t.packedLength+2}W.fromPositions=function(e){return e=c.u(e,c.u.EMPTY_OBJECT),r.o.defined("options.positions",e.positions),new W({polygonHierarchy:{positions:e.positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid})},W.pack=function(e,t,n){return r.o.typeOf.object("value",e),r.o.defined("array",t),n=c.u(n,0),n=h.y.packPolygonHierarchy(e._polygonHierarchy,t,n),s.t.pack(e._ellipsoid,t,n),n+=s.t.packedLength,b.n.pack(e._vertexFormat,t,n),n+=b.n.packedLength,t[n++]=e._stRotation,t[n]=e.packedLength,t};var Z=s.t.clone(s.t.UNIT_SPHERE),K=new b.n,X={polygonHierarchy:{}};return W.unpack=function(e,t,n){r.o.defined("array",e),t=c.u(t,0);var o=h.y.unpackPolygonHierarchy(e,t);t=o.startingIndex,delete o.startingIndex;var a=s.t.unpack(e,t,Z);t+=s.t.packedLength;var i=b.n.unpack(e,t,K);t+=b.n.packedLength;var p=e[t++],l=e[t];return c.e(n)||(n=new W(X)),n._polygonHierarchy=o,n._ellipsoid=s.t.clone(a,n._ellipsoid),n._vertexFormat=b.n.clone(i,n._vertexFormat),n._stRotation=p,n.packedLength=l,n},W.createGeometry=function(t){var o=t._vertexFormat,r=t._polygonHierarchy,i=t._stRotation,c=r.positions;if(!((c=e.D(c,a.t.equalsEpsilon,!0)).length<3)){var s=z,y=N,v=S,f=M,b=U;if(p.g.computeProjectTo2DArguments(c,j,f,b)){if(s=a.t.cross(f,b,s),s=a.t.normalize(s,s),!a.t.equalsEpsilon(j,a.t.ZERO,m.e.EPSILON6)){var w=t._ellipsoid.geodeticSurfaceNormal(j,J);a.t.dot(s,w)<0&&(s=a.t.negate(s,s),f=a.t.negate(f,f))}var A=p.g.createProjectPointsTo2DFunction(j,f,b),P=p.g.createProjectPointTo2DFunction(j,f,b);o.tangent&&(y=a.t.clone(f,y)),o.bitangent&&(v=a.t.clone(b,v));var x=h.y.polygonsFromHierarchy(r,A,!1),D=x.hierarchy,F=x.polygons;if(0!==D.length){c=D[0].outerRing;for(var T=n.i.fromPoints(c),_=h.y.computeBoundingRectangle(s,P,c,i,G),k=[],L=0;L<F.length;L++){var E=new d.d({geometry:Q(F[L],o,_,i,P,s,y,v)});k.push(E)}var C=u.k.combineInstances(k)[0];C.attributes.position.values=new Float64Array(C.attributes.position.values),C.indices=g.IndexDatatype.createTypedArray(C.attributes.position.values.length/3,C.indices);var R=C.attributes;return o.position||delete R.position,new l.I({attributes:R,indices:C.indices,primitiveType:C.primitiveType,boundingSphere:T})}}}},function(e,t){return c.e(t)&&(e=W.unpack(e,t)),W.createGeometry(e)}}));
