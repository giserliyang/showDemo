define(["exports","./Cartographic-1d953166","./Check-2514d21d","./when-d186add7","./Rectangle-f841217d","./Math-7f5f2992","./FeatureDetection-4281d393","./Event-50568704","./RuntimeError-4a74cd1a"],(function(e,t,r,n,o,i,u,a,s){"use strict";function c(e){this._ellipsoid=n.u(e,o.t.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(c.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),c.prototype.project=function(e,r){var o=this._semimajorAxis,i=e.longitude*o,u=e.latitude*o,a=e.height;return n.e(r)?(r.x=i,r.y=u,r.z=a,r):new t.t(i,u,a)},c.prototype.unproject=function(e,o){if(!n.e(e))throw new r.t("cartesian is required");var i=this._oneOverSemimajorAxis,u=e.x*i,a=e.y*i,s=e.z;return n.e(o)?(o.longitude=u,o.latitude=a,o.height=s,o):new t.t$1(u,a,s)};var p=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function f(e,t){this.start=n.u(e,0),this.stop=n.u(t,0)}function l(e,r){this.center=t.t.clone(n.u(e,t.t.ZERO)),this.radius=n.u(r,0)}var h=new t.t,d=new t.t,m=new t.t,y=new t.t,v=new t.t,g=new t.t,q=new t.t,b=new t.t,w=new t.t,O=new t.t,R=new t.t,x=new t.t,A=4/3*i.e.PI;l.fromPoints=function(e,r){if(n.e(r)||(r=new l),!n.e(e)||0===e.length)return r.center=t.t.clone(t.t.ZERO,r.center),r.radius=0,r;var o,i=t.t.clone(e[0],q),u=t.t.clone(i,h),a=t.t.clone(i,d),s=t.t.clone(i,m),c=t.t.clone(i,y),p=t.t.clone(i,v),f=t.t.clone(i,g),A=e.length;for(o=1;o<A;o++){t.t.clone(e[o],i);var S=i.x,E=i.y,_=i.z;S<u.x&&t.t.clone(i,u),S>c.x&&t.t.clone(i,c),E<a.y&&t.t.clone(i,a),E>p.y&&t.t.clone(i,p),_<s.z&&t.t.clone(i,s),_>f.z&&t.t.clone(i,f)}var C=t.t.magnitudeSquared(t.t.subtract(c,u,b)),I=t.t.magnitudeSquared(t.t.subtract(p,a,b)),T=t.t.magnitudeSquared(t.t.subtract(f,s,b)),U=u,P=c,j=C;I>j&&(j=I,U=a,P=p),T>j&&(j=T,U=s,P=f);var B=w;B.x=.5*(U.x+P.x),B.y=.5*(U.y+P.y),B.z=.5*(U.z+P.z);var k=t.t.magnitudeSquared(t.t.subtract(P,B,b)),D=Math.sqrt(k),z=O;z.x=u.x,z.y=a.y,z.z=s.z;var L=R;L.x=c.x,L.y=p.y,L.z=f.z;var K=t.t.midpoint(z,L,x),M=0;for(o=0;o<A;o++){t.t.clone(e[o],i);var F=t.t.magnitude(t.t.subtract(i,K,b));F>M&&(M=F);var N=t.t.magnitudeSquared(t.t.subtract(i,B,b));if(N>k){var H=Math.sqrt(N);k=(D=.5*(D+H))*D;var V=H-D;B.x=(D*B.x+V*i.x)/H,B.y=(D*B.y+V*i.y)/H,B.z=(D*B.z+V*i.z)/H}}return D<M?(t.t.clone(B,r.center),r.radius=D):(t.t.clone(K,r.center),r.radius=M),r};var S=new c,E=new t.t,_=new t.t,C=new t.t$1,I=new t.t$1;l.fromRectangle2D=function(e,t,r){return l.fromRectangleWithHeights2D(e,t,0,0,r)},l.fromRectangleWithHeights2D=function(e,r,i,u,a){if(n.e(a)||(a=new l),!n.e(e))return a.center=t.t.clone(t.t.ZERO,a.center),a.radius=0,a;r=n.u(r,S),o.h.southwest(e,C),C.height=i,o.h.northeast(e,I),I.height=u;var s=r.project(C,E),c=r.project(I,_),p=c.x-s.x,f=c.y-s.y,h=c.z-s.z;a.radius=.5*Math.sqrt(p*p+f*f+h*h);var d=a.center;return d.x=s.x+.5*p,d.y=s.y+.5*f,d.z=s.z+.5*h,a};var T=[];l.fromRectangle3D=function(e,r,i,u){if(r=n.u(r,o.t.WGS84),i=n.u(i,0),n.e(u)||(u=new l),!n.e(e))return u.center=t.t.clone(t.t.ZERO,u.center),u.radius=0,u;var a=o.h.subsample(e,r,i,T);return l.fromPoints(a,u)},l.fromVertices=function(e,o,i,u){if(n.e(u)||(u=new l),!n.e(e)||0===e.length)return u.center=t.t.clone(t.t.ZERO,u.center),u.radius=0,u;o=n.u(o,t.t.ZERO),i=n.u(i,3),r.o.typeOf.number.greaterThanOrEquals("stride",i,3);var a=q;a.x=e[0]+o.x,a.y=e[1]+o.y,a.z=e[2]+o.z;var s,c=t.t.clone(a,h),p=t.t.clone(a,d),f=t.t.clone(a,m),A=t.t.clone(a,y),S=t.t.clone(a,v),E=t.t.clone(a,g),_=e.length;for(s=0;s<_;s+=i){var C=e[s]+o.x,I=e[s+1]+o.y,T=e[s+2]+o.z;a.x=C,a.y=I,a.z=T,C<c.x&&t.t.clone(a,c),C>A.x&&t.t.clone(a,A),I<p.y&&t.t.clone(a,p),I>S.y&&t.t.clone(a,S),T<f.z&&t.t.clone(a,f),T>E.z&&t.t.clone(a,E)}var U=t.t.magnitudeSquared(t.t.subtract(A,c,b)),P=t.t.magnitudeSquared(t.t.subtract(S,p,b)),j=t.t.magnitudeSquared(t.t.subtract(E,f,b)),B=c,k=A,D=U;P>D&&(D=P,B=p,k=S),j>D&&(D=j,B=f,k=E);var z=w;z.x=.5*(B.x+k.x),z.y=.5*(B.y+k.y),z.z=.5*(B.z+k.z);var L=t.t.magnitudeSquared(t.t.subtract(k,z,b)),K=Math.sqrt(L),M=O;M.x=c.x,M.y=p.y,M.z=f.z;var F=R;F.x=A.x,F.y=S.y,F.z=E.z;var N=t.t.midpoint(M,F,x),H=0;for(s=0;s<_;s+=i){a.x=e[s]+o.x,a.y=e[s+1]+o.y,a.z=e[s+2]+o.z;var V=t.t.magnitude(t.t.subtract(a,N,b));V>H&&(H=V);var Y=t.t.magnitudeSquared(t.t.subtract(a,z,b));if(Y>L){var J=Math.sqrt(Y);L=(K=.5*(K+J))*K;var X=J-K;z.x=(K*z.x+X*a.x)/J,z.y=(K*z.y+X*a.y)/J,z.z=(K*z.z+X*a.z)/J}}return K<H?(t.t.clone(z,u.center),u.radius=K):(t.t.clone(N,u.center),u.radius=H),u},l.fromEncodedCartesianVertices=function(e,r,o){if(n.e(o)||(o=new l),!n.e(e)||!n.e(r)||e.length!==r.length||0===e.length)return o.center=t.t.clone(t.t.ZERO,o.center),o.radius=0,o;var i=q;i.x=e[0]+r[0],i.y=e[1]+r[1],i.z=e[2]+r[2];var u,a=t.t.clone(i,h),s=t.t.clone(i,d),c=t.t.clone(i,m),p=t.t.clone(i,y),f=t.t.clone(i,v),A=t.t.clone(i,g),S=e.length;for(u=0;u<S;u+=3){var E=e[u]+r[u],_=e[u+1]+r[u+1],C=e[u+2]+r[u+2];i.x=E,i.y=_,i.z=C,E<a.x&&t.t.clone(i,a),E>p.x&&t.t.clone(i,p),_<s.y&&t.t.clone(i,s),_>f.y&&t.t.clone(i,f),C<c.z&&t.t.clone(i,c),C>A.z&&t.t.clone(i,A)}var I=t.t.magnitudeSquared(t.t.subtract(p,a,b)),T=t.t.magnitudeSquared(t.t.subtract(f,s,b)),U=t.t.magnitudeSquared(t.t.subtract(A,c,b)),P=a,j=p,B=I;T>B&&(B=T,P=s,j=f),U>B&&(B=U,P=c,j=A);var k=w;k.x=.5*(P.x+j.x),k.y=.5*(P.y+j.y),k.z=.5*(P.z+j.z);var D=t.t.magnitudeSquared(t.t.subtract(j,k,b)),z=Math.sqrt(D),L=O;L.x=a.x,L.y=s.y,L.z=c.z;var K=R;K.x=p.x,K.y=f.y,K.z=A.z;var M=t.t.midpoint(L,K,x),F=0;for(u=0;u<S;u+=3){i.x=e[u]+r[u],i.y=e[u+1]+r[u+1],i.z=e[u+2]+r[u+2];var N=t.t.magnitude(t.t.subtract(i,M,b));N>F&&(F=N);var H=t.t.magnitudeSquared(t.t.subtract(i,k,b));if(H>D){var V=Math.sqrt(H);D=(z=.5*(z+V))*z;var Y=V-z;k.x=(z*k.x+Y*i.x)/V,k.y=(z*k.y+Y*i.y)/V,k.z=(z*k.z+Y*i.z)/V}}return z<F?(t.t.clone(k,o.center),o.radius=z):(t.t.clone(M,o.center),o.radius=F),o},l.fromCornerPoints=function(e,o,i){r.o.typeOf.object("corner",e),r.o.typeOf.object("oppositeCorner",o),n.e(i)||(i=new l);var u=t.t.midpoint(e,o,i.center);return i.radius=t.t.distance(u,o),i},l.fromEllipsoid=function(e,o){return r.o.typeOf.object("ellipsoid",e),n.e(o)||(o=new l),t.t.clone(t.t.ZERO,o.center),o.radius=e.maximumRadius,o};var U=new t.t;l.fromBoundingSpheres=function(e,r){if(n.e(r)||(r=new l),!n.e(e)||0===e.length)return r.center=t.t.clone(t.t.ZERO,r.center),r.radius=0,r;var o=e.length;if(1===o)return l.clone(e[0],r);if(2===o)return l.union(e[0],e[1],r);var i,u=[];for(i=0;i<o;i++)u.push(e[i].center);var a=(r=l.fromPoints(u,r)).center,s=r.radius;for(i=0;i<o;i++){var c=e[i];s=Math.max(s,t.t.distance(a,c.center,U)+c.radius)}return r.radius=s,r};var P=new t.t,j=new t.t,B=new t.t;l.fromOrientedBoundingBox=function(e,o){r.o.defined("orientedBoundingBox",e),n.e(o)||(o=new l);var i=e.halfAxes,a=u.p.getColumn(i,0,P),s=u.p.getColumn(i,1,j),c=u.p.getColumn(i,2,B);return t.t.add(a,s,a),t.t.add(a,c,a),o.center=t.t.clone(e.center,o.center),o.radius=t.t.magnitude(a),o},l.clone=function(e,r){if(n.e(e))return n.e(r)?(r.center=t.t.clone(e.center,r.center),r.radius=e.radius,r):new l(e.center,e.radius)},l.packedLength=4,l.pack=function(e,t,o){r.o.typeOf.object("value",e),r.o.defined("array",t),o=n.u(o,0);var i=e.center;return t[o++]=i.x,t[o++]=i.y,t[o++]=i.z,t[o]=e.radius,t},l.unpack=function(e,t,o){r.o.defined("array",e),t=n.u(t,0),n.e(o)||(o=new l);var i=o.center;return i.x=e[t++],i.y=e[t++],i.z=e[t++],o.radius=e[t],o};var k=new t.t,D=new t.t;l.union=function(e,o,i){r.o.typeOf.object("left",e),r.o.typeOf.object("right",o),n.e(i)||(i=new l);var u=e.center,a=e.radius,s=o.center,c=o.radius,p=t.t.subtract(s,u,k),f=t.t.magnitude(p);if(a>=f+c)return e.clone(i),i;if(c>=f+a)return o.clone(i),i;var h=.5*(a+f+c),d=t.t.multiplyByScalar(p,(-a+h)/f,D);return t.t.add(d,u,d),t.t.clone(d,i.center),i.radius=h,i};var z=new t.t;l.expand=function(e,n,o){r.o.typeOf.object("sphere",e),r.o.typeOf.object("point",n),o=l.clone(e,o);var i=t.t.magnitude(t.t.subtract(n,o.center,z));return i>o.radius&&(o.radius=i),o},l.intersectPlane=function(e,n){r.o.typeOf.object("sphere",e),r.o.typeOf.object("plane",n);var o=e.center,i=e.radius,u=n.normal,a=t.t.dot(u,o)+n.distance;return a<-i?p.OUTSIDE:a<i?p.INTERSECTING:p.INSIDE},l.transform=function(e,t,o){return r.o.typeOf.object("sphere",e),r.o.typeOf.object("transform",t),n.e(o)||(o=new l),o.center=u.y.multiplyByPoint(t,e.center,o.center),o.radius=u.y.getMaximumScale(t)*e.radius,o};var L=new t.t;l.distanceSquaredTo=function(e,n){r.o.typeOf.object("sphere",e),r.o.typeOf.object("cartesian",n);var o=t.t.subtract(e.center,n,L);return t.t.magnitudeSquared(o)-e.radius*e.radius},l.transformWithoutScale=function(e,t,o){return r.o.typeOf.object("sphere",e),r.o.typeOf.object("transform",t),n.e(o)||(o=new l),o.center=u.y.multiplyByPoint(t,e.center,o.center),o.radius=e.radius,o};var K=new t.t;l.computePlaneDistances=function(e,o,i,u){r.o.typeOf.object("sphere",e),r.o.typeOf.object("position",o),r.o.typeOf.object("direction",i),n.e(u)||(u=new f);var a=t.t.subtract(e.center,o,K),s=t.t.dot(i,a);return u.start=s-e.radius,u.stop=s+e.radius,u};for(var M=new t.t,F=new t.t,N=new t.t,H=new t.t,V=new t.t,Y=new t.t$1,J=new Array(8),X=0;X<8;++X)J[X]=new t.t;var G=new c;function Q(e){if(e instanceof Q)this.scheme=e.scheme,this.authority=e.authority,this.path=e.path,this.query=e.query,this.fragment=e.fragment;else if(e){var t=Z.exec(e);this.scheme=t[1],this.authority=t[2],this.path=t[3],this.query=t[4],this.fragment=t[5]}}l.projectTo2D=function(e,o,i){r.o.typeOf.object("sphere",e);var u,a=(o=n.u(o,G)).ellipsoid,s=e.center,c=e.radius;u=t.t.equals(s,t.t.ZERO)?t.t.clone(t.t.UNIT_X,M):a.geodeticSurfaceNormal(s,M);var p=t.t.cross(t.t.UNIT_Z,u,F);t.t.normalize(p,p);var f=t.t.cross(u,p,N);t.t.normalize(f,f),t.t.multiplyByScalar(u,c,u),t.t.multiplyByScalar(f,c,f),t.t.multiplyByScalar(p,c,p);var h=t.t.negate(f,V),d=t.t.negate(p,H),m=J,y=m[0];t.t.add(u,f,y),t.t.add(y,p,y),y=m[1],t.t.add(u,f,y),t.t.add(y,d,y),y=m[2],t.t.add(u,h,y),t.t.add(y,d,y),y=m[3],t.t.add(u,h,y),t.t.add(y,p,y),t.t.negate(u,u),y=m[4],t.t.add(u,f,y),t.t.add(y,p,y),y=m[5],t.t.add(u,f,y),t.t.add(y,d,y),y=m[6],t.t.add(u,h,y),t.t.add(y,d,y),y=m[7],t.t.add(u,h,y),t.t.add(y,p,y);for(var v=m.length,g=0;g<v;++g){var q=m[g];t.t.add(s,q,q);var b=a.cartesianToCartographic(q,Y);o.project(b,q)}var w=(s=(i=l.fromPoints(m,i)).center).x,O=s.y,R=s.z;return s.x=R,s.y=w,s.z=O,i},l.isOccluded=function(e,t){return r.o.typeOf.object("sphere",e),r.o.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},l.equals=function(e,r){return e===r||n.e(e)&&n.e(r)&&t.t.equals(e.center,r.center)&&e.radius===r.radius},l.prototype.intersectPlane=function(e){return l.intersectPlane(this,e)},l.prototype.distanceSquaredTo=function(e){return l.distanceSquaredTo(this,e)},l.prototype.computePlaneDistances=function(e,t,r){return l.computePlaneDistances(this,e,t,r)},l.prototype.isOccluded=function(e){return l.isOccluded(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.volume=function(){var e=this.radius;return A*e*e*e},Q.prototype.scheme=null,Q.prototype.authority=null,Q.prototype.path="",Q.prototype.query=null,Q.prototype.fragment=null;var Z=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");Q.prototype.getScheme=function(){return this.scheme},Q.prototype.getAuthority=function(){return this.authority},Q.prototype.getPath=function(){return this.path},Q.prototype.getQuery=function(){return this.query},Q.prototype.getFragment=function(){return this.fragment},Q.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},Q.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},Q.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},Q.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(ee,re).replace(W,te)),this.path&&(this.path=this.path.replace(W,te)),this.query&&(this.query=this.query.replace(W,te)),this.fragment&&(this.fragment=this.fragment.replace(W,te))};var W=/%[0-9a-z]{2}/gi,$=/[a-zA-Z0-9\-\._~]/,ee=/(.*@)?([^@:]*)(:.*)?/;function te(e){var t=unescape(e);return $.test(t)?t:e.toUpperCase()}function re(e,t,r,n){return(t||"")+r.toLowerCase()+(n||"")}function ne(e,t){if(null===e||"object"!=typeof e)return e;t=n.u(t,!1);var r=new e.constructor;for(var o in e)if(e.hasOwnProperty(o)){var i=e[o];t&&(i=ne(i,t)),r[o]=i}return r}function oe(e,t,r){r=n.u(r,!1);var o,i,u,a={},s=n.e(e),c=n.e(t);if(s)for(o in e)e.hasOwnProperty(o)&&(i=e[o],c&&r&&"object"==typeof i&&t.hasOwnProperty(o)?(u=t[o],a[o]="object"==typeof u?oe(i,u,r):i):a[o]=i);if(c)for(o in t)t.hasOwnProperty(o)&&!a.hasOwnProperty(o)&&(u=t[o],a[o]=u);return a}function ie(e,t){var r;return"undefined"!=typeof document&&(r=document),ie._implementation(e,t,r)}Q.prototype.resolve=function(e){var t=new Q;return this.scheme?(t.scheme=this.scheme,t.authority=this.authority,t.path=this.path,t.query=this.query):(t.scheme=e.scheme,this.authority?(t.authority=this.authority,t.path=this.path,t.query=this.query):(t.authority=e.authority,""==this.path?(t.path=e.path,t.query=this.query||e.query):("/"==this.path.charAt(0)?(t.path=this.path,t.removeDotSegments()):(e.authority&&""==e.path?t.path="/"+this.path:t.path=e.path.substring(0,e.path.lastIndexOf("/")+1)+this.path,t.removeDotSegments()),t.query=this.query))),t.fragment=this.fragment,t},Q.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),r=[],n=""==t[0];n&&t.shift();for(""==t[0]&&t.shift();t.length;)".."==(e=t.shift())?r.pop():"."!=e&&r.push(e);("."==e||".."==e)&&r.push(""),n&&r.unshift(""),this.path=r.join("/")},Q.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},ie._implementation=function(e,t,o){if(!n.e(e))throw new r.t("relative uri is required.");if(!n.e(t)){if(void 0===o)return e;t=n.u(o.baseURI,o.location.href)}var i=new Q(t);return new Q(e).resolve(i).toString()};var ue,ae=/^blob:/i;function se(e){return r.o.typeOf.string("uri",e),ae.test(e)}var ce=/^data:/i;function pe(e){return r.o.typeOf.string("uri",e),ce.test(e)}var fe=Object.freeze({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5}),le=Object.freeze({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3,PACK:4,BLOCK:5,BLOCKPACK:6});function he(e){e=n.u(e,n.u.EMPTY_OBJECT);var t=n.u(e.throttleByServer,!1),r=n.u(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=n.u(e.priority,0),this.throttle=r,this.throttleByServer=t,this.type=n.u(e.type,le.OTHER),this.serverKey=void 0,this.state=fe.UNISSUED,this.deferred=void 0,this.cancelled=!1}function de(e,t,r){this.statusCode=e,this.response=t,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=function(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),n=0;n<r.length;++n){var o=r[n],i=o.indexOf(": ");if(i>0){var u=o.substring(0,i),a=o.substring(i+2);t[u]=a}}return t}(this.responseHeaders))}function me(e){r.o.typeOf.object("options",e),r.o.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function ye(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}he.prototype.cancel=function(){this.cancelled=!0},he.prototype.clone=function(e){return n.e(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new he(this)},de.prototype.toString=function(){var e="Request has failed.";return n.e(this.statusCode)&&(e+=" Status Code: "+this.statusCode),e},Object.defineProperties(me.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),me.prototype.reserve=function(e){e=n.u(e,this._length),this._array.length=e},me.prototype.heapify=function(e){e=n.u(e,0);for(var t=this._length,r=this._comparator,o=this._array,i=-1,u=!0;u;){var a=2*(e+1),s=a-1;i=s<t&&r(o[s],o[e])<0?s:e,a<t&&r(o[a],o[i])<0&&(i=a),i!==e?(ye(o,i,e),e=i):u=!1}},me.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},me.prototype.insert=function(e){r.o.defined("element",e);var t,o=this._array,i=this._comparator,u=this._maximumLength,a=this._length++;for(a<o.length?o[a]=e:o.push(e);0!==a;){var s=Math.floor((a-1)/2);if(!(i(o[a],o[s])<0))break;ye(o,a,s),a=s}return n.e(u)&&this._length>u&&(t=o[u],o.pop(),this._length=u),t},me.prototype.pop=function(e){if(e=n.u(e,0),0!==this._length){r.o.typeOf.number.lessThan("index",e,this._length);var t=this._array,o=t[e];return ye(t,e,--this._length),t[this._length]=void 0,this.heapify(e),o}};var ve="undefined"!=typeof performance&&"function"==typeof performance.now&&isFinite(performance.now())?function(){return performance.now()}:function(){return Date.now()};function ge(e,t){return e.priority-t.priority}var qe={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0,totalRequestTime:0},be=20,we=new me({comparator:ge});we.maximumLength=be,we.reserve(be);var Oe=[],Re={},xe="undefined"!=typeof document?new Q(document.location.href):new Q,Ae=new a.o;function Se(){}function Ee(e){n.e(e.priorityFunction)&&(e.priority=e.priorityFunction())}function _e(e){var t=n.u(Se.requestsByServer[e],Se.maximumRequestsPerServer);return Re[e]<t}function Ce(e){return n.e(e.packKey)||(e.packKey=e.serverKey+"_"+e.providerName),e.packKey}function Ie(e){return n.e(e.blockKey)||(e.blockKey=e.serverKey+"_"+e.providerName+"_"+e.quadKey+e.url.substring(e.url.indexOf("dataVersion"))),e.blockKey}function Te(e){var t=Ce(e);return n.e(Se.packRequestGroup[t])||(Se.packRequestGroup[t]=[]),n.e(Se.packRequestQuadKey[t])||(Se.packRequestQuadKey[t]=""),n.e(Se.packRequestPromise[t])||(Se.packRequestPromise[t]=n.o.defer()),n.e(Se.quadKeyIndex[t])||(Se.quadKeyIndex[t]=0),e.quadKeyIndex=Se.quadKeyIndex[t]++,e.deferred=Se.packRequestPromise[t],e.state=fe.ISSUED,Se.packRequestGroup[t].push(e),e.deferred.promise}function Ue(e){for(var t=0,r=e.length;t<r;t++){e[t].state=fe.CANCELLED}}function Pe(e){for(var t=[],r={},n=0,o=e.length;n<o;n++){var i=e[n];if(!i.cancelled){var u=i.quadKey;r[u]||(r[u]=!0,t.push(u))}}return t}function je(){var e=Se.packRequestGroup;for(var t in e)if(e.hasOwnProperty(t)){var r=e[t];if(r.length<1)continue;var o=r[0].clone(),i=-1!==o.url.indexOf("rest/maps");o.serverKey=r[0].serverKey,o.state=r[0].state;var u=o.url,a=Pe(r);if(a.length<1)continue;Se.packRequestQuadKey[t]=i?a.join(","):a.join(";");var s=Se.packRequestQuadKey[t];if(o.throttleByServer&&!_e(o.serverKey)){Ue(r),Se.packRequestPromise[t].reject();continue}o.deferred=Se.packRequestPromise[t];var c=new Q(u);c.query=i?n.e(c.query)?c.query+"&tiles="+s:"tiles="+s:n.e(c.query)?c.query+"&extratiles="+s:"extratiles="+s,o.url=c.toString(),De(o,o.url)}Se.packRequestGroup={},Se.packRequestPromise={},Se.packRequestQuadKey={},Se.quadKeyIndex={}}function Be(){var e=Se.blockRequest;for(var t in e)if(e.hasOwnProperty(t)){De(e[t])}Se.blockRequest={}}function ke(e){if(e.state===fe.UNISSUED)if(e.state=fe.ISSUED,e.type===le.PACK||e.type===le.BLOCKPACK){var t=Ce(e);n.e(Se.packRequestPromise[t])||(Se.packRequestPromise[t]=n.o.defer()),e.deferred=Se.packRequestPromise[t]}else e.deferred=n.o.defer();return e.deferred.promise}function De(e,t){var r=ke(e);return e.state=fe.ACTIVE,Oe.push(e),++qe.numberOfActiveRequests,++qe.numberOfActiveRequestsEver,++Re[e.serverKey],e.startTime=ve(),e.requestFunction(t).then(function(e){return function(t){if(e.state!==fe.CANCELLED&&(--qe.numberOfActiveRequests,--Re[e.serverKey],Ae.raiseEvent(),e.state=fe.RECEIVED,e.deferred.resolve(t),e.endTime=ve(),(Se.statisticRequestTime>0||e.type!==le.OTHER)&&(qe.totalRequestTime+=e.endTime-e.startTime),e.type===le.BLOCK||e.type===le.BLOCKPACK)){var r=Ie(e);n.e(Se.blockDefer[r])&&(Se.blockDefer[r]=void 0,delete Se.blockDefer[r])}}}(e)).otherwise(function(e){return function(t){e.state!==fe.CANCELLED&&(++qe.numberOfFailedRequests,--qe.numberOfActiveRequests,--Re[e.serverKey],Ae.raiseEvent(t),e.state=fe.FAILED,e.deferred.reject(t))}}(e)),r}function ze(e){var t=e.state===fe.ACTIVE;e.state=fe.CANCELLED,++qe.numberOfCancelledRequests,e.deferred.reject(),t&&(--qe.numberOfActiveRequests,--Re[e.serverKey],++qe.numberOfCancelledActiveRequests),n.e(e.cancelFunction)&&e.cancelFunction()}Se.TIMEOUT=5e3,Se.CANCLE_COUNT=3,Se.statisticRequestTime=-1,Se.maximumRequests=50,Se.maximumRequestsPerServer=6,Se.perPacketCount=20,Se.requestsByServer={},Se.throttleRequests=!0,Se.debugShowStatistics=!1,Se.requestCompletedEvent=Ae,Object.defineProperties(Se,{activeRequestLength:{get:function(){return Oe.length}},statistics:{get:function(){return qe}},priorityHeapLength:{get:function(){return be},set:function(e){if(e<be)for(;we.length>e;){ze(we.pop())}be=e,we.maximumLength=e,we.reserve(e)}}}),Se.packRequestGroup={},Se.packRequestPromise={},Se.packRequestQuadKey={},Se.quadKeyIndex={},Se.packRequestHeap={},Se.blockDefer={},Se.blockRequest={},Se.update=function(){var e,t,r=0,n=Oe.length;for(e=0;e<n;++e)(t=Oe[e]).cancelled&&ze(t),t.state===fe.ACTIVE?r>0&&(Oe[e-r]=t):++r;Oe.length-=r;var o=we.internalArray,i=we.length;for(e=0;e<i;++e)Ee(o[e]);we.resort(),function(){for(var e in Se.packRequestHeap)if(Se.packRequestHeap.hasOwnProperty(e)){for(var t=Se.packRequestHeap[e],r=t.internalArray,n=t.length,o=0;o<n;++o)Ee(r[o]);t.resort()}}(),Be(),function(){for(var e in Se.packRequestHeap)if(Se.packRequestHeap.hasOwnProperty(e))for(var t=Se.packRequestHeap[e];t.length>0;){var r=t.pop();r.cancelled?ze(r):Te(r)}je()}();for(var u=Math.max(Se.maximumRequests-Oe.length,0),a=0;a<u&&we.length>0;)(t=we.pop()).cancelled?ze(t):!t.throttleByServer||_e(t.serverKey)?(De(t),++a):ze(t);!Se.debugShowStatistics||(0===qe.numberOfActiveRequests&&qe.lastNumberOfActiveRequests>0&&(qe.numberOfAttemptedRequests>0&&(console.log("Number of attempted requests: "+qe.numberOfAttemptedRequests),qe.numberOfAttemptedRequests=0),qe.numberOfCancelledRequests>0&&(console.log("Number of cancelled requests: "+qe.numberOfCancelledRequests),qe.numberOfCancelledRequests=0),qe.numberOfCancelledActiveRequests>0&&(console.log("Number of cancelled active requests: "+qe.numberOfCancelledActiveRequests),qe.numberOfCancelledActiveRequests=0),qe.numberOfFailedRequests>0&&(console.log("Number of failed requests: "+qe.numberOfFailedRequests),qe.numberOfFailedRequests=0)),qe.lastNumberOfActiveRequests=qe.numberOfActiveRequests)},Se.getServerKey=function(e){r.o.typeOf.string("url",e);var t=new Q(e).resolve(xe);t.normalize();var o=t.authority;/:/.test(o)||(o=o+":"+("https"===t.scheme?"443":"80"));var i=Re[o];return n.e(i)||(Re[o]=0),o},Se.request=function(e){if(r.o.typeOf.object("request",e),r.o.typeOf.string("request.url",e.url),r.o.typeOf.func("request.requestFunction",e.requestFunction),pe(e.url)||se(e.url))return Ae.raiseEvent(),e.state=fe.RECEIVED,e.requestFunction();if(++qe.numberOfAttemptedRequests,n.e(e.serverKey)||(e.serverKey=Se.getServerKey(e.url)),e.type===le.BLOCK)return function(e){var t=Ie(e),r=Se.blockDefer[t];return n.e(r)||(r=Se.blockDefer[t]=n.o.defer(),Se.blockRequest[t]=e),e.deferred=r,e.state=fe.ISSUED,e.deferred.promise}(e);if(!e.throttleByServer||_e(e.serverKey)){if(!Se.throttleRequests||!e.throttle)return De(e);if(!(Oe.length>=Se.maximumRequests)){var t;if(Ee(e),e.type===le.PACK||e.type===le.BLOCKPACK){var o=function(e){var t=Ce(e),r=Se.packRequestHeap[t];return n.e(r)||((r=Se.packRequestHeap[t]=new me({comparator:ge})).maximumLength=Se.perPacketCount,r.reserve(be)),r}(e),i=!0;if(e.type===le.BLOCKPACK)for(var u=0;u<o.length;u++)if(o._array[u].quadKey===e.quadKey){e.blockRequest=o._array[u],i=!1;break}i&&(t=o.insert(e))}else t=we.insert(e);if(n.e(t)){if(t===e)return;ze(t)}return ke(e)}}},Se.clearForSpecs=function(){for(;we.length>0;){ze(we.pop())}for(var e=Oe.length,t=0;t<e;++t)ze(Oe[t]);Oe.length=0,Re={},qe.numberOfAttemptedRequests=0,qe.numberOfActiveRequests=0,qe.numberOfCancelledRequests=0,qe.numberOfCancelledActiveRequests=0,qe.numberOfFailedRequests=0,qe.numberOfActiveRequestsEver=0,qe.lastNumberOfActiveRequests=0,qe.totalRequestTime=0},Se.numberOfActiveRequestsByServer=function(e){return Re[e]},Se.requestHeap=we;var Le={},Ke={};Le.add=function(e,t){if(!n.e(e))throw new r.t("host is required.");if(!n.e(t)||t<=0)throw new r.t("port is required to be greater than 0.");var o=e.toLowerCase()+":"+t;n.e(Ke[o])||(Ke[o]=!0)},Le.remove=function(e,t){if(!n.e(e))throw new r.t("host is required.");if(!n.e(t)||t<=0)throw new r.t("port is required to be greater than 0.");var o=e.toLowerCase()+":"+t;n.e(Ke[o])&&delete Ke[o]},Le.contains=function(e){if(!n.e(e))throw new r.t("url is required.");var t=function(e){var t=new Q(e);t.normalize();var r=t.getAuthority();if(n.e(r)){if(-1!==r.indexOf("@")){var o=r.split("@");r=o[1]}if(-1===r.indexOf(":")){var i=t.getScheme();if(n.e(i)||(i=(i=window.location.protocol).substring(0,i.length-1)),"http"===i)r+=":80";else{if("https"!==i)return;r+=":443"}}return r}}(e);return!(!n.e(t)||!n.e(Ke[t]))},Le.clear=function(){Ke={}};var Me={};function Fe(e,t){if(!n.e(e))throw new r.t("identifier is required.");n.e(Me[e])||(Me[e]=!0,console.warn(n.u(t,e)))}Fe.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",Fe.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",Fe.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",Fe.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored";var Ne,He=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function Ve(e,t,o,i){var u,a=e.query;if(!n.e(a)||0===a.length)return{};if(-1===a.indexOf("=")){var s={};s[a]=void 0,u=s}else u=function(e){if(!n.e(e))throw new r.t("queryString is required.");var t={};if(""===e)return t;for(var o=e.replace(/\+/g,"%20").split(/[&;]/),i=0,u=o.length;i<u;++i){var a=o[i].split("=");if(a.length>2){var s=o[i].indexOf("=");a=[o[i].substring(0,s),o[i].substring(s+1,o[i].length)]}var c=decodeURIComponent(a[0]),p=a[1];p=n.e(p)?decodeURIComponent(p):"";var f=t[c];"string"==typeof f?t[c]=[f,p]:Array.isArray(f)?f.push(p):t[c]=p}return t}(a);t._queryParameters=o?Ge(u,t._queryParameters,i):u,e.query=void 0}function Ye(e,t){var o=t._queryParameters,i=Object.keys(o);1!==i.length||n.e(o[i[0]])?e.query=function(e,t){if(!n.e(e))throw new r.t("obj is required.");var o="";for(var i in e)if(e.hasOwnProperty(i)){var u=e[i],a=encodeURIComponent(i)+"=";if(Array.isArray(u))for(var s=0,c=u.length;s<c;++s)o+=!0===t?a+encodeURI(u[s])+"&":a+encodeURIComponent(u[s])+"&";else o+=!0===t?a+encodeURI(u)+"&":a+encodeURIComponent(u)+"&"}return o.slice(0,-1)}(o):e.query=i[0]}function Je(e,t){return n.e(e)?n.e(e.clone)?e.clone():ne(e):t}function Xe(e){if(e.state===fe.ISSUED||e.state===fe.ACTIVE)throw new s.t("The Resource is already being fetched.");e.state=fe.UNISSUED,e.deferred=void 0}function Ge(e,t,r){if(!r)return oe(e,t);var o=ne(e,!0);for(var i in t)if(t.hasOwnProperty(i)){var u=o[i],a=t[i];n.e(u)?(Array.isArray(u)||(u=o[i]=[u]),o[i]=u.concat(a)):o[i]=Array.isArray(a)?a.slice():a}return o}function Qe(e){"string"==typeof(e=n.u(e,n.u.EMPTY_OBJECT))&&(e={url:e}),r.o.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=Je(e.templateValues,{}),this._queryParameters=Je(e.queryParameters,{}),this.headers=Je(e.headers,{}),this.request=n.u(e.request,new he),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=n.u(e.retryAttempts,0),this._retryCount=0;var t=new Q(e.url);Ve(t,this,!0,!0),t.fragment=void 0,this._url=t.toString()}function Ze(e){var t=e.resource,r=e.flipY,o=e.preferImageBitmap,i=t.request;i.url=t.url,i.requestFunction=function(){var e=!1;!t.isDataUri&&!t.isBlobUri&&(e=t.isCrossOriginUrl);var u=n.o.defer();return Qe._Implementations.createImage(i,e,u,r,o),u.promise};var u=Se.request(i);if(n.e(u))return u.otherwise((function(e){return i.state!==fe.FAILED?n.o.reject(e):t.retryOnError(e).then((function(u){return u?(i.state=fe.UNISSUED,i.deferred=void 0,Ze({resource:t,flipY:r,preferImageBitmap:o})):n.o.reject(e)}))}))}function We(e,t,r){var o={};o[t]=r,e.setQueryParameters(o);var i=e.request;i.url=e.url,i.requestFunction=function(){var t=n.o.defer();return window[r]=function(e){t.resolve(e);try{delete window[r]}catch(e){window[r]=void 0}},Qe._Implementations.loadAndExecuteScript(e.url,r,t),t.promise};var u=Se.request(i);if(n.e(u))return u.otherwise((function(o){return i.state!==fe.FAILED?n.o.reject(o):e.retryOnError(o).then((function(u){return u?(i.state=fe.UNISSUED,i.deferred=void 0,We(e,t,r)):n.o.reject(o)}))}))}Qe.createIfNeeded=function(e){return e instanceof Qe?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new Qe({url:e})},Qe.supportsImageBitmapOptions=function(){if(n.e(Ne))return Ne;if("function"!=typeof createImageBitmap)return Ne=n.o.resolve(!1);return Ne=Qe.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWP4////fwAJ+wP9CNHoHgAAAABJRU5ErkJggg=="}).then((function(e){return createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none"})})).then((function(e){return!0})).otherwise((function(){return!1})),Ne},Object.defineProperties(Qe,{isBlobSupported:{get:function(){return He}}}),Object.defineProperties(Qe.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){var t=new Q(e);Ve(t,this,!1),t.fragment=void 0,this._url=t.toString()}},extension:{get:function(){return function(e){if(!n.e(e))throw new r.t("uri is required.");var t=new Q(e);t.normalize();var o=t.path,i=o.lastIndexOf("/");return-1!==i&&(o=o.substr(i+1)),i=o.lastIndexOf("."),-1===i?"":o.substr(i+1)}(this._url)}},isDataUri:{get:function(){return pe(this._url)}},isBlobUri:{get:function(){return se(this._url)}},isCrossOriginUrl:{get:function(){return function(e){n.e(ue)||(ue=document.createElement("a")),ue.href=window.location.href;var t=ue.host,r=ue.protocol;return ue.href=e,ue.href=ue.href,r!==ue.protocol||t!==ue.host}(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}}),Qe.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;var r=new Q(this._url);e&&Ye(r,this);var o=r.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),i=this._templateValues;return o=o.replace(/{(.*?)}/g,(function(e,t){var r=i[t];return n.e(r)&&"s"==t?encodeURI(r):n.e(r)?encodeURIComponent(r):e})),t&&n.e(this.proxy)&&(o=this.proxy.getURL(o)),o},Qe.prototype.setQueryParameters=function(e,t){this._queryParameters=t?Ge(this._queryParameters,e,!1):Ge(e,this._queryParameters,!1)},Qe.prototype.appendQueryParameters=function(e){this._queryParameters=Ge(e,this._queryParameters,!0)},Qe.prototype.setTemplateValues=function(e,t){this._templateValues=t?oe(this._templateValues,e):oe(e,this._templateValues)},Qe.prototype.getDerivedResource=function(e){var t=this.clone();if(t._retryCount=0,n.e(e.url)){var r=new Q(e.url);Ve(r,t,!0,n.u(e.preserveQueryParameters,!1)),r.fragment=void 0,t._url=r.resolve(new Q(ie(this._url))).toString()}return n.e(e.queryParameters)&&(t._queryParameters=oe(e.queryParameters,t._queryParameters)),n.e(e.templateValues)&&(t._templateValues=oe(e.templateValues,t.templateValues)),n.e(e.headers)&&(t.headers=oe(e.headers,t.headers)),n.e(e.proxy)&&(t.proxy=e.proxy),n.e(e.request)&&(t.request=e.request),n.e(e.retryCallback)&&(t.retryCallback=e.retryCallback),n.e(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},Qe.prototype.retryOnError=function(e){var t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return n.o(!1);var r=this;return n.o(t(this,e)).then((function(e){return++r._retryCount,e}))},Qe.prototype.clone=function(e){return n.e(e)||(e=new Qe({url:this._url})),e._url=this._url,e._queryParameters=ne(this._queryParameters),e._templateValues=ne(this._templateValues),e.headers=ne(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e},Qe.prototype.getBaseUri=function(e){return function(e,t){if(!n.e(e))throw new r.t("uri is required.");var o="",i=e.lastIndexOf("/");return-1!==i&&(o=e.substring(0,i+1)),t&&(e=new Q(e),n.e(e.query)&&(o+="?"+e.query),n.e(e.fragment)&&(o+="#"+e.fragment)),o}(this.getUrlComponent(e),e)},Qe.prototype.appendForwardSlash=function(){this._url=function(e){return(0===e.length||"/"!==e[e.length-1])&&(e+="/"),e}(this._url)},Qe.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},Qe.fetchArrayBuffer=function(e){return new Qe(e).fetchArrayBuffer()},Qe.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},Qe.fetchBlob=function(e){return new Qe(e).fetchBlob()},Qe.prototype.fetchImage=function(e){e=n.u(e,n.u.EMPTY_OBJECT);var t=n.u(e.preferImageBitmap,!1),r=n.u(e.preferBlob,!1),o=n.u(e.flipY,!1);if(Xe(this.request),!He||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!r)return Ze({resource:this,flipY:o,preferImageBitmap:t});var i,u,a,s=this.fetchBlob();return n.e(s)?Qe.supportsImageBitmapOptions().then((function(e){return i=e&&t,s})).then((function(e){if(n.e(e)){if(a=e,i)return Qe.createImageBitmapFromBlob(e,{flipY:o,premultiplyAlpha:!1});var t=window.URL.createObjectURL(e);return Ze({resource:u=new Qe({url:t}),flipY:o,preferImageBitmap:!1})}})).then((function(e){if(n.e(e))return e.blob=a,i||window.URL.revokeObjectURL(u.url),e})).otherwise((function(e){return n.e(u)&&window.URL.revokeObjectURL(u.url),e.blob=a,n.o.reject(e)})):void 0},Qe.fetchImage=function(e){return new Qe(e).fetchImage({flipY:e.flipY,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},Qe.prototype.fetchText=function(){return this.fetch({responseType:"text"})},Qe.fetchText=function(e){return new Qe(e).fetchText()},Qe.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(n.e(e))return e.then((function(e){if(n.e(e))return JSON.parse(e)}))},Qe.fetchJson=function(e){return new Qe(e).fetchJson()},Qe.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},Qe.fetchXML=function(e){return new Qe(e).fetchXML()},Qe.prototype.fetchJsonp=function(e){var t;e=n.u(e,"callback"),Xe(this.request);do{t="loadJsonp"+Math.random().toString().substring(2,8)}while(n.e(window[t]));return We(this,e,t)},Qe.fetchJsonp=function(e){return new Qe(e).fetchJsonp(e.callbackParameterName)},Qe.prototype._makeRequest=function(e){var t=this;Xe(t.request);var r=t.request;r.url=t.url,r.requestFunction=function(o){var i=e.responseType,u=oe(e.headers,t.headers),a=e.overrideMimeType,s=e.method,c=e.data,p=n.o.defer(),f=n.e(o)?o:t.url,l=Qe._Implementations.loadWithXhr(f,i,s,c,u,p,a);return n.e(l)&&n.e(l.abort)&&(r.cancelFunction=function(){l.abort()}),p.promise};var o=Se.request(r);if(n.e(o))return o.then((function(e){return e})).otherwise((function(o){return r.state!==fe.FAILED?n.o.reject(o):t.retryOnError(o).then((function(i){return i?(r.state=fe.UNISSUED,r.deferred=void 0,t.fetch(e)):n.o.reject(o)}))}))};var $e=/^data:(.*?)(;base64)?,(.*)$/;function et(e,t){var r=decodeURIComponent(t);return e?atob(r):r}function tt(e,t){for(var r=et(e,t),n=new ArrayBuffer(r.length),o=new Uint8Array(n),i=0;i<r.length;i++)o[i]=r.charCodeAt(i);return n}function rt(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}Qe.prototype.fetch=function(e){return(e=Je(e,{})).method="GET",this._makeRequest(e)},Qe.fetch=function(e){return new Qe(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Qe.prototype.delete=function(e){return(e=Je(e,{})).method="DELETE",this._makeRequest(e)},Qe.delete=function(e){return new Qe(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},Qe.prototype.head=function(e){return(e=Je(e,{})).method="HEAD",this._makeRequest(e)},Qe.head=function(e){return new Qe(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Qe.prototype.options=function(e){return(e=Je(e,{})).method="OPTIONS",this._makeRequest(e)},Qe.options=function(e){return new Qe(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Qe.prototype.post=function(e,t){return r.o.defined("data",e),(t=Je(t,{})).method="POST",t.data=e,this._makeRequest(t)},Qe.post=function(e){return new Qe(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Qe.prototype.put=function(e,t){return r.o.defined("data",e),(t=Je(t,{})).method="PUT",t.data=e,this._makeRequest(t)},Qe.put=function(e){return new Qe(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Qe.prototype.patch=function(e,t){return r.o.defined("data",e),(t=Je(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},Qe.patch=function(e){return new Qe(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Qe._Implementations={},Qe._Implementations.createImage=function(e,t,r,o,i){var u=e.url;Qe.supportsImageBitmapOptions().then((function(a){if(a&&i){var c=n.o.defer(),p=Qe._Implementations.loadWithXhr(u,"blob","GET",void 0,void 0,c,void 0,void 0,void 0);return n.e(p)&&n.e(p.abort)&&(e.cancelFunction=function(){p.abort()}),c.promise.then((function(e){if(n.e(e))return Qe.createImageBitmapFromBlob(e,{flipY:o,premultiplyAlpha:!1});r.reject(new s.t("Successfully retrieved "+u+" but it contained no content."))})).then(r.resolve)}!function(e,t,r){var n=new Image;n.crossOrigin="",n.onload=function(){r.resolve(n)},n.onerror=function(e){r.reject(e)},t&&(Le.contains(e)?n.crossOrigin="use-credentials":n.crossOrigin=""),n.src=e}(u,t,r)})).otherwise(r.reject)},Qe.createImageBitmapFromBlob=function(e,t){return r.o.defined("options",t),r.o.typeOf.bool("options.flipY",t.flipY),r.o.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none"})};var nt="undefined"==typeof XMLHttpRequest;Qe._Implementations.loadWithXhr=function(e,t,o,i,u,a,c){var p=$e.exec(e);if(null===p){if(!nt){var f=new XMLHttpRequest;if(Le.contains(e)&&(f.withCredentials=!0),e=e.replace(/{/g,"%7B").replace(/}/g,"%7D"),f.open(o,e,!0),n.e(c)&&n.e(f.overrideMimeType)&&f.overrideMimeType(c),n.e(u))for(var l in u)u.hasOwnProperty(l)&&f.setRequestHeader(l,u[l]);n.e(t)&&(f.responseType=t);var h=!1;return"string"==typeof e&&(h=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),f.onload=function(){if(!(f.status<200||f.status>=300)||h&&0===f.status){var e=f.response,r=f.responseType;if("HEAD"===o||"OPTIONS"===o){var i=f.getAllResponseHeaders().trim().split(/[\r\n]+/),u={};return i.forEach((function(e){var t=e.split(": "),r=t.shift();u[r]=t.join(": ")})),void a.resolve(u)}if(204===f.status)a.resolve();else if(!n.e(e)||n.e(t)&&r!==t)if("json"===t&&"string"==typeof e)try{a.resolve(JSON.parse(e))}catch(e){a.reject(e)}else(""===r||"document"===r)&&n.e(f.responseXML)&&f.responseXML.hasChildNodes()?a.resolve(f.responseXML):""!==r&&"text"!==r||!n.e(f.responseText)?a.reject(new s.t("Invalid XMLHttpRequest response type.")):a.resolve(f.responseText);else a.resolve(e)}else a.reject(new de(f.status,f.response,f.getAllResponseHeaders()))},f.onerror=function(e){a.reject(new de)},f.send(i),f}!function(e,t,r,n,o,i,u){var a=require("url").parse(e),c="https:"===a.protocol?require("https"):require("http"),p=require("zlib"),f={protocol:a.protocol,hostname:a.hostname,port:a.port,path:a.path,query:a.query,method:r,headers:o};c.request(f).on("response",(function(e){if(e.statusCode<200||e.statusCode>=300)i.reject(new de(e.statusCode,e,e.headers));else{var r=[];e.on("data",(function(e){r.push(e)})),e.on("end",(function(){var n=Buffer.concat(r);"gzip"===e.headers["content-encoding"]?p.gunzip(n,(function(e,r){e?i.reject(new s.t("Error decompressing response.")):i.resolve(rt(r,t))})):i.resolve(rt(n,t))}))}})).on("error",(function(e){i.reject(new de)})).end()}(e,t,o,0,u,a)}else a.resolve(function(e,t){t=n.u(t,"");var o=e[1],i=!!e[2],u=e[3];switch(t){case"":case"text":return et(i,u);case"arraybuffer":return tt(i,u);case"blob":var a=tt(i,u);return new Blob([a],{type:o});case"document":return(new DOMParser).parseFromString(et(i,u),o);case"json":return JSON.parse(et(i,u));default:throw new r.t("Unhandled responseType: "+t)}}(p,t))},Qe._Implementations.loadAndExecuteScript=function(e,t,r){return function(e){var t=n.o.defer(),r=document.createElement("script");r.async=!0,r.src=e;var o=document.getElementsByTagName("head")[0];return r.onload=function(){r.onload=void 0,o.removeChild(r),t.resolve()},r.onerror=function(e){t.reject(e)},o.appendChild(r),t.promise}(e).otherwise(r.reject)},Qe._DefaultImplementations={},Qe._DefaultImplementations.createImage=Qe._Implementations.createImage,Qe._DefaultImplementations.loadWithXhr=Qe._Implementations.loadWithXhr,Qe._DefaultImplementations.loadAndExecuteScript=Qe._Implementations.loadAndExecuteScript,Qe.DEFAULT=Object.freeze(new Qe({url:"undefined"==typeof document?"":document.location.href.split("?")[0]}));var ot,it,ut,at=/((?:.*\/)|^)Cesium\.js$/;function st(e){return"undefined"==typeof document?e:(n.e(ot)||(ot=document.createElement("a")),ot.href=e,ot.href=ot.href,ot.href)}function ct(){if(n.e(it))return it;var e;if(e="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:"object"==typeof define&&n.e(define.amd)&&!define.amd.toUrlUndefined&&n.e(require.toUrl)?ie("..",lt("Core/buildModuleUrl.js")):function(){for(var e=document.getElementsByTagName("script"),t=0,r=e.length;t<r;++t){var n=e[t].getAttribute("src"),o=at.exec(n);if(null!==o)return o[1]}}(),!n.e(e))throw new r.t("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return(it=new Qe({url:st(e)})).appendForwardSlash(),it}function pt(e){return st(require.toUrl("../"+e))}function ft(e){return ct().getDerivedResource({url:e}).url}function lt(e){return n.e(ut)||(ut="object"==typeof define&&n.e(define.amd)&&!define.amd.toUrlUndefined&&n.e(require.toUrl)?pt:ft),ut(e)}lt._cesiumScriptRegex=at,lt._buildModuleUrlFromBaseUrl=ft,lt._clearBaseResource=function(){it=void 0},lt.setBaseUrl=function(e){it=Qe.DEFAULT.getDerivedResource({url:e})},lt.getCesiumBaseUrl=ct,e.S=p,e.e=Fe,e.i=l,e.n=c,e.n$1=lt,e.o=f,e.t=Qe}));
